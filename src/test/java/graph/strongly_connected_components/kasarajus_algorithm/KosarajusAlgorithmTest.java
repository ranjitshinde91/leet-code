package graph.strongly_connected_components.kasarajus_algorithm;

import graph.GraphAdjacencyListBuilder;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.Arguments;
import org.junit.jupiter.params.provider.MethodSource;

import java.util.ArrayList;
import java.util.stream.Stream;

import static graph.EdgeType.UNWEIGHTED;
import static graph.GraphType.DIRECTED;
import static org.assertj.core.api.Assertions.assertThat;

class KosarajusAlgorithmTest {

    @ParameterizedTest
    @MethodSource("inputs")
    void test(String input, int expected) {
        var graphAdjacencyMatrixBuilder = new GraphAdjacencyListBuilder();
        var adjacencyList = graphAdjacencyMatrixBuilder.build(input, DIRECTED, UNWEIGHTED);

        var kosarajusAlgorithm = new KosarajusAlgorithm();

        var noOfStronglyConnectedComponents = kosarajusAlgorithm.stronglyConnectedComponents(adjacencyList.size(), adjacencyList);

        assertThat(noOfStronglyConnectedComponents).isEqualTo(expected);
    }

    private static Stream<Arguments> inputs() {
        return Stream.of(
                Arguments.of(
                        "5 5\n" +
                                "0 1\n" +
                                "1 2\n" +
                                "1 3\n" +
                                "3 4\n" +
                                "2 0"
                        ,
                        3),
                Arguments.of(
                        "129 555\n" +
                                "0 26\n" +
                                "0 51\n" +
                                "0 55\n" +
                                "0 58\n" +
                                "0 80\n" +
                                "0 114\n" +
                                "1 16\n" +
                                "1 51\n" +
                                "1 88\n" +
                                "2 18\n" +
                                "2 68\n" +
                                "2 91\n" +
                                "3 6\n" +
                                "3 18\n" +
                                "3 25\n" +
                                "3 51\n" +
                                "3 60\n" +
                                "3 63\n" +
                                "3 68\n" +
                                "3 82\n" +
                                "3 122\n" +
                                "4 32\n" +
                                "4 52\n" +
                                "4 60\n" +
                                "4 122\n" +
                                "5 1\n" +
                                "5 30\n" +
                                "5 68\n" +
                                "5 91\n" +
                                "6 5\n" +
                                "6 89\n" +
                                "6 93\n" +
                                "6 122\n" +
                                "7 5\n" +
                                "7 26\n" +
                                "7 54\n" +
                                "7 120\n" +
                                "8 1\n" +
                                "8 36\n" +
                                "8 40\n" +
                                "8 99\n" +
                                "8 103\n" +
                                "8 121\n" +
                                "8 125\n" +
                                "10 10\n" +
                                "10 19\n" +
                                "10 50\n" +
                                "10 62\n" +
                                "10 99\n" +
                                "10 101\n" +
                                "10 103\n" +
                                "11 26\n" +
                                "11 68\n" +
                                "11 92\n" +
                                "12 1\n" +
                                "12 126\n" +
                                "13 20\n" +
                                "13 21\n" +
                                "13 50\n" +
                                "13 53\n" +
                                "13 95\n" +
                                "13 116\n" +
                                "14 7\n" +
                                "14 44\n" +
                                "15 6\n" +
                                "15 16\n" +
                                "15 34\n" +
                                "15 74\n" +
                                "15 92\n" +
                                "15 98\n" +
                                "15 123\n" +
                                "16 8\n" +
                                "16 15\n" +
                                "16 16\n" +
                                "16 59\n" +
                                "16 92\n" +
                                "16 123\n" +
                                "17 9\n" +
                                "17 13\n" +
                                "17 17\n" +
                                "17 43\n" +
                                "17 118\n" +
                                "18 48\n" +
                                "18 53\n" +
                                "18 67\n" +
                                "18 89\n" +
                                "18 92\n" +
                                "18 113\n" +
                                "18 115\n" +
                                "19 20\n" +
                                "19 39\n" +
                                "19 44\n" +
                                "19 62\n" +
                                "19 70\n" +
                                "19 84\n" +
                                "19 100\n" +
                                "19 128\n" +
                                "20 8\n" +
                                "20 14\n" +
                                "20 19\n" +
                                "20 91\n" +
                                "21 64\n" +
                                "21 97\n" +
                                "21 123\n" +
                                "22 42\n" +
                                "23 3\n" +
                                "23 94\n" +
                                "23 123\n" +
                                "24 25\n" +
                                "24 42\n" +
                                "24 57\n" +
                                "24 63\n" +
                                "24 75\n" +
                                "24 89\n" +
                                "25 120\n" +
                                "26 26\n" +
                                "26 40\n" +
                                "26 75\n" +
                                "27 27\n" +
                                "27 95\n" +
                                "27 98\n" +
                                "27 126\n" +
                                "28 1\n" +
                                "28 5\n" +
                                "28 27\n" +
                                "28 51\n" +
                                "28 97\n" +
                                "28 109\n" +
                                "28 119\n" +
                                "29 1\n" +
                                "29 32\n" +
                                "29 40\n" +
                                "29 91\n" +
                                "29 115\n" +
                                "30 13\n" +
                                "30 33\n" +
                                "30 46\n" +
                                "30 59\n" +
                                "30 79\n" +
                                "30 85\n" +
                                "30 105\n" +
                                "30 112\n" +
                                "31 79\n" +
                                "31 115\n" +
                                "31 117\n" +
                                "32 41\n" +
                                "32 118\n" +
                                "32 120\n" +
                                "32 125\n" +
                                "32 127\n" +
                                "33 16\n" +
                                "33 51\n" +
                                "33 85\n" +
                                "34 41\n" +
                                "34 67\n" +
                                "35 1\n" +
                                "35 101\n" +
                                "36 30\n" +
                                "36 41\n" +
                                "36 79\n" +
                                "37 100\n" +
                                "38 10\n" +
                                "38 25\n" +
                                "38 28\n" +
                                "38 61\n" +
                                "38 110\n" +
                                "39 8\n" +
                                "39 18\n" +
                                "39 65\n" +
                                "40 33\n" +
                                "40 41\n" +
                                "40 51\n" +
                                "40 103\n" +
                                "40 109\n" +
                                "41 15\n" +
                                "41 29\n" +
                                "41 71\n" +
                                "42 40\n" +
                                "42 62\n" +
                                "42 105\n" +
                                "42 112\n" +
                                "42 123\n" +
                                "43 24\n" +
                                "43 42\n" +
                                "44 60\n" +
                                "45 16\n" +
                                "45 32\n" +
                                "45 39\n" +
                                "45 57\n" +
                                "45 76\n" +
                                "45 79\n" +
                                "45 117\n" +
                                "46 81\n" +
                                "46 105\n" +
                                "46 107\n" +
                                "47 41\n" +
                                "47 59\n" +
                                "47 60\n" +
                                "47 123\n" +
                                "48 13\n" +
                                "48 17\n" +
                                "48 27\n" +
                                "48 42\n" +
                                "48 88\n" +
                                "48 92\n" +
                                "48 108\n" +
                                "49 9\n" +
                                "49 20\n" +
                                "49 41\n" +
                                "49 98\n" +
                                "50 1\n" +
                                "50 27\n" +
                                "50 58\n" +
                                "50 60\n" +
                                "50 103\n" +
                                "50 124\n" +
                                "50 125\n" +
                                "51 20\n" +
                                "51 27\n" +
                                "51 28\n" +
                                "51 79\n" +
                                "51 111\n" +
                                "51 113\n" +
                                "52 48\n" +
                                "52 67\n" +
                                "53 8\n" +
                                "53 9\n" +
                                "53 28\n" +
                                "53 34\n" +
                                "53 102\n" +
                                "54 32\n" +
                                "54 43\n" +
                                "54 49\n" +
                                "54 65\n" +
                                "54 73\n" +
                                "54 81\n" +
                                "55 33\n" +
                                "55 89\n" +
                                "55 102\n" +
                                "56 1\n" +
                                "56 5\n" +
                                "56 27\n" +
                                "56 37\n" +
                                "56 40\n" +
                                "56 57\n" +
                                "57 33\n" +
                                "57 115\n" +
                                "58 66\n" +
                                "58 75\n" +
                                "58 92\n" +
                                "58 101\n" +
                                "59 3\n" +
                                "59 4\n" +
                                "59 51\n" +
                                "59 79\n" +
                                "59 89\n" +
                                "59 105\n" +
                                "59 108\n" +
                                "60 14\n" +
                                "60 15\n" +
                                "60 93\n" +
                                "60 111\n" +
                                "60 126\n" +
                                "61 4\n" +
                                "61 5\n" +
                                "61 46\n" +
                                "61 93\n" +
                                "62 7\n" +
                                "62 39\n" +
                                "62 44\n" +
                                "62 77\n" +
                                "62 124\n" +
                                "63 13\n" +
                                "63 33\n" +
                                "63 40\n" +
                                "63 60\n" +
                                "63 80\n" +
                                "63 97\n" +
                                "63 106\n" +
                                "64 32\n" +
                                "64 127\n" +
                                "65 0\n" +
                                "65 54\n" +
                                "65 91\n" +
                                "65 100\n" +
                                "66 24\n" +
                                "66 91\n" +
                                "66 93\n" +
                                "67 14\n" +
                                "67 21\n" +
                                "67 24\n" +
                                "67 79\n" +
                                "68 4\n" +
                                "68 80\n" +
                                "69 1\n" +
                                "69 12\n" +
                                "69 37\n" +
                                "69 56\n" +
                                "69 83\n" +
                                "69 97\n" +
                                "69 102\n" +
                                "69 116\n" +
                                "70 88\n" +
                                "70 96\n" +
                                "71 23\n" +
                                "71 37\n" +
                                "71 52\n" +
                                "71 73\n" +
                                "71 82\n" +
                                "71 83\n" +
                                "71 99\n" +
                                "71 102\n" +
                                "72 7\n" +
                                "72 24\n" +
                                "72 64\n" +
                                "72 74\n" +
                                "72 95\n" +
                                "72 99\n" +
                                "72 109\n" +
                                "73 55\n" +
                                "73 56\n" +
                                "73 96\n" +
                                "73 126\n" +
                                "74 15\n" +
                                "74 20\n" +
                                "74 69\n" +
                                "74 82\n" +
                                "74 89\n" +
                                "75 5\n" +
                                "75 111\n" +
                                "75 125\n" +
                                "76 21\n" +
                                "76 24\n" +
                                "76 54\n" +
                                "76 96\n" +
                                "77 52\n" +
                                "77 61\n" +
                                "77 65\n" +
                                "78 7\n" +
                                "78 11\n" +
                                "78 104\n" +
                                "79 71\n" +
                                "79 81\n" +
                                "79 118\n" +
                                "80 34\n" +
                                "80 55\n" +
                                "80 58\n" +
                                "80 62\n" +
                                "80 108\n" +
                                "81 97\n" +
                                "81 118\n" +
                                "82 15\n" +
                                "82 24\n" +
                                "82 30\n" +
                                "82 31\n" +
                                "82 59\n" +
                                "82 94\n" +
                                "83 16\n" +
                                "83 25\n" +
                                "83 57\n" +
                                "83 68\n" +
                                "83 83\n" +
                                "84 4\n" +
                                "84 15\n" +
                                "84 16\n" +
                                "84 33\n" +
                                "84 64\n" +
                                "84 113\n" +
                                "85 10\n" +
                                "85 72\n" +
                                "85 116\n" +
                                "86 11\n" +
                                "87 55\n" +
                                "87 86\n" +
                                "87 103\n" +
                                "87 117\n" +
                                "87 123\n" +
                                "89 19\n" +
                                "89 37\n" +
                                "89 44\n" +
                                "89 46\n" +
                                "89 105\n" +
                                "90 10\n" +
                                "90 28\n" +
                                "90 31\n" +
                                "90 58\n" +
                                "90 70\n" +
                                "90 92\n" +
                                "91 91\n" +
                                "92 72\n" +
                                "92 88\n" +
                                "93 8\n" +
                                "93 23\n" +
                                "93 51\n" +
                                "93 80\n" +
                                "93 98\n" +
                                "93 104\n" +
                                "93 119\n" +
                                "94 4\n" +
                                "94 14\n" +
                                "94 111\n" +
                                "94 125\n" +
                                "95 5\n" +
                                "95 54\n" +
                                "95 80\n" +
                                "95 91\n" +
                                "95 102\n" +
                                "96 19\n" +
                                "96 25\n" +
                                "96 48\n" +
                                "96 57\n" +
                                "96 59\n" +
                                "96 75\n" +
                                "96 86\n" +
                                "97 4\n" +
                                "97 19\n" +
                                "97 36\n" +
                                "97 56\n" +
                                "98 41\n" +
                                "98 57\n" +
                                "98 101\n" +
                                "98 108\n" +
                                "99 14\n" +
                                "99 16\n" +
                                "99 50\n" +
                                "99 67\n" +
                                "100 9\n" +
                                "100 23\n" +
                                "100 42\n" +
                                "100 59\n" +
                                "100 67\n" +
                                "100 82\n" +
                                "101 63\n" +
                                "101 85\n" +
                                "101 93\n" +
                                "101 110\n" +
                                "102 30\n" +
                                "102 52\n" +
                                "103 39\n" +
                                "103 89\n" +
                                "103 119\n" +
                                "103 127\n" +
                                "104 29\n" +
                                "104 65\n" +
                                "104 90\n" +
                                "104 94\n" +
                                "104 119\n" +
                                "105 23\n" +
                                "105 103\n" +
                                "105 114\n" +
                                "106 1\n" +
                                "106 21\n" +
                                "106 47\n" +
                                "106 60\n" +
                                "106 63\n" +
                                "107 10\n" +
                                "107 28\n" +
                                "107 31\n" +
                                "107 53\n" +
                                "107 111\n" +
                                "107 124\n" +
                                "108 59\n" +
                                "109 23\n" +
                                "109 83\n" +
                                "109 88\n" +
                                "110 18\n" +
                                "110 35\n" +
                                "110 68\n" +
                                "110 73\n" +
                                "110 87\n" +
                                "110 120\n" +
                                "111 15\n" +
                                "111 88\n" +
                                "111 91\n" +
                                "111 125\n" +
                                "111 127\n" +
                                "112 47\n" +
                                "112 48\n" +
                                "112 53\n" +
                                "112 55\n" +
                                "112 89\n" +
                                "112 106\n" +
                                "113 11\n" +
                                "113 46\n" +
                                "113 123\n" +
                                "114 40\n" +
                                "114 48\n" +
                                "114 49\n" +
                                "114 50\n" +
                                "114 76\n" +
                                "114 87\n" +
                                "114 110\n" +
                                "115 40\n" +
                                "115 49\n" +
                                "115 55\n" +
                                "115 63\n" +
                                "115 73\n" +
                                "115 112\n" +
                                "115 114\n" +
                                "116 7\n" +
                                "116 14\n" +
                                "116 35\n" +
                                "116 60\n" +
                                "116 101\n" +
                                "116 107\n" +
                                "116 124\n" +
                                "117 44\n" +
                                "117 66\n" +
                                "117 79\n" +
                                "117 81\n" +
                                "118 90\n" +
                                "118 97\n" +
                                "118 128\n" +
                                "119 123\n" +
                                "120 0\n" +
                                "120 14\n" +
                                "120 42\n" +
                                "120 89\n" +
                                "120 116\n" +
                                "120 119\n" +
                                "121 50\n" +
                                "121 105\n" +
                                "121 113\n" +
                                "122 27\n" +
                                "122 63\n" +
                                "122 70\n" +
                                "122 106\n" +
                                "122 114\n" +
                                "122 120\n" +
                                "123 41\n" +
                                "123 94\n" +
                                "123 115\n" +
                                "124 26\n" +
                                "124 63\n" +
                                "124 70\n" +
                                "124 75\n" +
                                "124 78\n" +
                                "124 79\n" +
                                "125 26\n" +
                                "125 107\n" +
                                "126 0\n" +
                                "126 19\n" +
                                "126 83\n" +
                                "126 95\n" +
                                "126 100\n" +
                                "126 116\n" +
                                "127 25\n" +
                                "127 38\n" +
                                "127 42\n" +
                                "127 115\n" +
                                "128 33\n" +
                                "128 48\n" +
                                "128 81\n" +
                                "128 102\n" +
                                "128 103"
                        ,7)
        );
    }
}